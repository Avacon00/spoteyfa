<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apple-Style Spotify Player</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Setup Wizard (initially visible if no credentials) -->
    <div class="setup-wizard" id="setupWizard">
        <!-- Step 1: Welcome -->
        <div class="wizard-step" id="step1">
            <div class="wizard-header">
                <h2>üéµ Willkommen bei Spoteyfa</h2>
                <div class="step-indicator">Schritt 1 von 3</div>
            </div>
            
            <div class="wizard-content">
                <div class="welcome-icon">üéß</div>
                <p>Um Spoteyfa zu nutzen, musst du es mit deinem Spotify-Account √ºber die Spotify Developer API verbinden.</p>
                <p><strong>Keine Sorge!</strong> Wir f√ºhren dich durch den Einrichtungsprozess.</p>
                
                <div class="wizard-buttons">
                    <button class="btn btn-primary" onclick="nextStep()">Loslegen</button>
                </div>
            </div>
        </div>
        
        <!-- Step 2: Developer Guide -->
        <div class="wizard-step" id="step2" style="display: none;">
            <div class="wizard-header">
                <h2>üîß Spotify Developer Einrichtung</h2>
                <div class="step-indicator">Schritt 2 von 3</div>
            </div>
            
            <div class="wizard-content">
                <div class="guide-steps">
                    <div class="guide-step">
                        <span class="step-number">1</span>
                        <div class="step-text">
                            <strong>Spotify Developer Account erstellen</strong>
                            <p>Gehe zu <a href="#" onclick="openSpotifyDev()" class="link">developer.spotify.com</a> und melde dich mit deinem Spotify-Account an</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <span class="step-number">2</span>
                        <div class="step-text">
                            <strong>Neue App erstellen</strong>
                            <p>Klicke auf "Create an App" und gib einen Namen ein wie "Mein Spoteyfa Player"</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <span class="step-number">3</span>
                        <div class="step-text">
                            <strong>Redirect URI setzen</strong>
                            <p>In den App-Einstellungen hinzuf√ºgen: <code>http://127.0.0.1:8888/callback</code></p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <span class="step-number">4</span>
                        <div class="step-text">
                            <strong>Zugangsdaten kopieren</strong>
                            <p>Kopiere deine <strong>Client ID</strong> und dein <strong>Client Secret</strong></p>
                        </div>
                    </div>
                </div>
                
                <div class="wizard-buttons">
                    <button class="btn btn-secondary" onclick="prevStep()">Zur√ºck</button>
                    <button class="btn btn-primary" onclick="nextStep()">Ich bin bereit</button>
                </div>
            </div>
        </div>
        
        <!-- Step 3: Credentials Input -->
        <div class="wizard-step" id="step3" style="display: none;">
            <div class="wizard-header">
                <h2>üîë Zugangsdaten eingeben</h2>
                <div class="step-indicator">Schritt 3 von 3</div>
            </div>
            
            <div class="wizard-content">
                <div class="input-group">
                    <label for="clientId">
                        Client ID 
                        <button class="help-btn" onclick="showHelp('clientId')" title="Hilfe">?</button>
                    </label>
                    <input type="text" id="clientId" placeholder="F√ºge deine Client ID hier ein" class="wizard-input">
                    <div class="help-tooltip" id="helpClientId" style="display: none;">
                        Du findest diese in deinem Spotify App Dashboard unter "Client ID"
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="clientSecret">
                        Client Secret 
                        <button class="help-btn" onclick="showHelp('clientSecret')" title="Hilfe">?</button>
                    </label>
                    <input type="password" id="clientSecret" placeholder="F√ºge dein Client Secret hier ein" class="wizard-input">
                    <div class="help-tooltip" id="helpClientSecret" style="display: none;">
                        Klicke auf "Show Client Secret" in deinem Spotify App Dashboard
                    </div>
                    <button type="button" onclick="togglePassword()" class="show-password">üëÅ</button>
                </div>
                
                <div class="validation-status" id="validationStatus"></div>
                
                <div class="wizard-buttons">
                    <button class="btn btn-secondary" onclick="prevStep()">Zur√ºck</button>
                    <button class="btn btn-primary" onclick="validateAndStart()" id="startBtn">
                        <span class="btn-text">Spoteyfa starten</span>
                        <span class="spinner" style="display: none;">‚è≥</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="player-widget" id="playerWidget" style="display: none;">
        <!-- Header with Close Button and Theme Toggle -->
        <header class="player-header">
            <button class="theme-toggle-btn" id="themeToggle" title="Dark/Light Mode">üåô</button>
            <button class="close-btn" id="closeBtn">‚úï</button>
        </header>

        <!-- Album Cover (240x240px) -->
        <div class="album-cover" id="albumCover">
            <img id="coverImage" style="display: none;" alt="Album Cover">
            <div class="cover-placeholder" id="coverPlaceholder">üéµ</div>
        </div>

        <!-- Song Information -->
        <div class="song-info">
            <h1 class="song-title" id="songTitle">Spotify Player</h1>
            <h2 class="artist-name" id="artistName">Wird geladen...</h2>
            <h3 class="album-name" id="albumName">Bitte warten</h3>
        </div>

        <!-- Progress Section -->
        <div class="progress-section">
            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <!-- Time Display -->
            <div class="time-info">
                <span class="time-current" id="timeCurrent">0:00</span>
                <span class="time-total" id="timeTotal">0:00</span>
            </div>
        </div>

        <!-- Media Controls -->
        <div class="media-controls">
            <button class="control-btn" id="prevBtn" title="Previous">‚èÆ</button>
            <button class="control-btn play-btn" id="playBtn" title="Play/Pause">‚è∏</button>
            <button class="control-btn" id="nextBtn" title="Next">‚è≠</button>
        </div>

        <!-- Volume Control -->
        <div class="volume-section">
            <span class="volume-icon">üîä</span>
            <div class="volume-container">
                <div class="volume-bar">
                    <div class="volume-fill" id="volumeFill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Spotify Configuration will be loaded securely via electronAPI -->

    <script src="setup-wizard.js"></script>
    <script src="renderer.js"></script>
</body>
</html>